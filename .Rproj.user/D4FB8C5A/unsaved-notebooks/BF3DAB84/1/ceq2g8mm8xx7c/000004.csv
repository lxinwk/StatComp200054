"0","knn_classi<-function(train_data,obse,type,calcols,classcol,idcol,k)"
"0","{"
"0","  distance<-function(train_data,obse,type)"
"0","  {"
"0","    r<-nrow(train_data)"
"0","    near_distance<-matrix(nrow=r,ncol=1)"
"0","    for(i in 1:r){"
"0","      near_distance[i]<-norm(cbind(train_data[i,]-obse),type)#zhao		"
"0","    }"
"0","    near_distance"
"0","  }"
"0","  knn<-function(train_data,obse,type,calcols,classcol,idcol)"
"0","  {"
"0","    d<-distance(train_data[,calcols],obse,type)"
"0","    m <- data.frame(train_data[,idcol],train_data[,classcol],d)"
"0","    m"
"0","  }"
"0","  all_near<-knn(train_data,obse,type,calcols,classcol,idcol)"
"0","  all_near<-all_near[order(all_near[,3]),]"
"0","  r<-nrow(all_near)"
"0","  cla<-unique(all_near[,2])"
"0","  probs<-matrix(cla,ncol=2,nrow=length(cla),byrow=FALSE)"
"0","  k_nearest<-all_near[1:k,]"
"0","  freqs<-as.data.frame(table(k_nearest[,2]))"
"0","  freqs[,2]<-freqs[,2]/k"
"0","  #probs[,2]=probs[,2]/k"
"0","  colnames(freqs)<-c(""class"",""probs"")"
"0","  freqs<-freqs[order(freqs[,2],decreasing = TRUE),]"
"0","  re <- freqs[1,]"
"0","  re"
"0","}"
"0","knn_classi(iris,c(11,22),'2',c(2:3),4,1,5)#c(121,203)"
