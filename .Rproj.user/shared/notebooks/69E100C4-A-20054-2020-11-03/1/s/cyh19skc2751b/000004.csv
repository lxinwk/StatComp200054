"0","library(DAAG)"
"0","attach(ironslag)"
"2","The following objects are masked from ironslag (pos = 3):

    chemical, magnetic

"
"0","M <- magnetic"
"0","n <- length(M)"
"0","e1 <- e2 <- e3 <- e4 <- matrix(0,n,n)"
"0","for (i in 1:n) {"
"0","  "
"0","  for (j in (i+1):n-1){"
"0","    y <- magnetic[-c(i,j)]"
"0","    x <- chemical[-c(i,j)]"
"0","    "
"0","    J1 <- lm(y ~ x)"
"0","    yhat1 <- J1$coef[1] + J1$coef[2] * chemical[c(i,j)]"
"0","    e1[i,j] <- mean((magnetic[c(i,j)] - yhat1)^2)"
"0","    "
"0","    J2 <- lm(y ~ x + I(x^2))"
"0","    yhat2 <- J2$coef[1] + J2$coef[2] * chemical[c(i,j)] + J2$coef[3] *"
"0","      chemical[c(i,j)]^2"
"0","    e2[i,j] <- mean((magnetic[c(i,j)] - yhat2)^2)"
"0","    "
"0","    J3 <- lm(log(y) ~ x)"
"0","    logyhat3 <- J3$coef[1] + J3$coef[2] * chemical[c(i,j)]"
"0","    yhat3 <- exp(logyhat3)"
"0","    e3[i,j] <-mean(( magnetic[c(i,j)] - yhat3)^2)"
"0","    "
"0","    J4 <- lm(log(y) ~ log(x))"
"0","    logyhat4 <- J4$coef[1] + J4$coef[2] * log(chemical[c(i,j)])"
"0","    yhat4 <- exp(logyhat4)"
"0","    e4[i,j] <- mean((magnetic[c(i,j)] - yhat4)^2)"
"0","    "
"0","  }"
"0","  "
"0","}"
"0","c(2*sum(e1)/(n*(n-1)),2*sum(e2)/(n*(n-1)),2*sum(e3)/(n*(n-1)),2*sum(e4)/(n*(n-1)))"
"1","[1]"
"1"," 18.50408"
"1"," 16.55759"
"1"," 17.06077"
"1"," 19.09614"
"1","
"
